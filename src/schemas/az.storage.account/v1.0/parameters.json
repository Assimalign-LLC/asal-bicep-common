{
    "$schema": "http://json-schema.org/draft-07/schema",
    "definitions": {
        "storage-account": {
            "type": "object",
            "properties": {
                "value": {
                    "$ref": "#/definitions/storage-account-parameters"
                }
            },
            "required": [
                "value"
            ]
        },
        "storage-accounts": {
            "type": "object",
            "properties": {
                "value": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/storage-account-parameters"
                    },
                    "minItems": 1
                }
            },
            "required": [
                "value"
            ]
        },
        "storage-account-parameters": {
            "type": "object",
            "properties": {
                "storageAccountName": {
                    "type": "string"
                },
                "storageAccountResourceGroup": {
                    "type": "string"
                },
                "storageAccountTlsVersion": {
                    "type": "string",
                    "oneOf": [
                        {
                            "const": "TLS1_0"
                        },
                        {
                            "const": "TLS1_1"
                        },
                        {
                            "const": "TLS1_2"
                        }
                    ]
                },
                "storageAccountType": {
                    "type": "string",
                    "oneOf": [
                        {
                            "const": "Storage"
                        },
                        {
                            "const": "StorageV2"
                        },
                        {
                            "const": "BlobStorage"
                        },
                        {
                            "const": "BlockBlobStorage"
                        },
                        {
                            "const": "FileStorage"
                        }
                    ]
                },
                "storageAccountAccessTier": {
                    "type": "string",
                    "oneOf": [
                        {
                            "const": "hot"
                        },
                        {
                            "const": "cool"
                        }
                    ]
                },
                "storageAccountTier": {
                    "type": "object",
                    "properties": {
                        "dev": {
                            "type": "string"
                        },
                        "qa": {
                            "type": "string"
                        },
                        "uat": {
                            "type": "string"
                        },
                        "prd": {
                            "type": "string"
                        }
                    },
                    "required": [
                        "dev",
                        "qa",
                        "uat",
                        "prd"
                    ]
                },
                "storageAccountRedundancy": {
                    "type": "object",
                    "properties": {
                        "dev": {
                            "type": "string",
                            "oneOf": [
                                {
                                    "const": "LRS"
                                },
                                {
                                    "const": "GRS"
                                },
                                {
                                    "const": "RAGRS"
                                },
                                {
                                    "const": "ZRS"
                                }
                            ]
                        },
                        "qa": {
                            "type": "string",
                            "oneOf": [
                                {
                                    "const": "LRS"
                                },
                                {
                                    "const": "GRS"
                                },
                                {
                                    "const": "RAGRS"
                                },
                                {
                                    "const": "ZRS"
                                }
                            ]
                        },
                        "uat": {
                            "type": "string",
                            "oneOf": [
                                {
                                    "const": "LRS"
                                },
                                {
                                    "const": "GRS"
                                },
                                {
                                    "const": "RAGRS"
                                },
                                {
                                    "const": "ZRS"
                                }
                            ]
                        },
                        "prd": {
                            "type": "string",
                            "oneOf": [
                                {
                                    "const": "LRS"
                                },
                                {
                                    "const": "GRS"
                                },
                                {
                                    "const": "RAGRS"
                                },
                                {
                                    "const": "ZRS"
                                }
                            ]
                        }
                    },
                    "required": [
                        "dev",
                        "qa",
                        "uat",
                        "prd"
                    ]
                },
                "storageAccountVirtualNetworkDefaultAccess": {
                    "type": "string",
                    "default": "Allow",
                    "oneOf": [
                        {
                            "const": "Allow"
                        },
                        {
                            "const": "Deny"
                        }
                    ]
                },
                "storageAccountVirtualNetworks": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "allowAccess": {
                                "type": "boolean",
                                "default": true
                            },
                            "virtualNetwork": {
                                "type": "string"
                            },
                            "virtualNetworkSubnet": {
                                "type": "string"
                            },
                            "virtualNetworkResourceGroup": {
                                "type": "string"
                            }
                        },
                        "required": [
                            "allowAccess",
                            "virtualNetwork",
                            "virtualNetworkSubnet",
                            "virtualNetworkResourceGroup"
                        ]
                    }
                },
                "storageAccountVirtualNetworkBypass": {
                    "type": "string",
                    "default": "AzureServices",
                    "oneOf": [
                        {
                            "const": "AzureServices"
                        },
                        {
                            "const": "Logging"
                        },
                        {
                            "const": "Metrics"
                        },
                        {
                            "const": "None"
                        }
                    ]
                },
                "storageAccountResourceAccess": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "resourceName": {
                                "type": "string"
                            },
                            "resourceType": {
                                "type": "string"
                            },
                            "resourceGroup": {
                                "type": "string"
                            }
                        },
                        "required": [
                            "resourceName",
                            "resourceType",
                            "resourceGroup"
                        ]
                    }
                },
                "storageAccountBlobServices": {
                    "$ref": "#/definitions/storage-account-blob-service-parameters"
                },
                "storageAccountQueueServices": {
                    "$ref": "#/definitions/storage-account-queue-service-parameters"
                },
                "storageAccountFileShareServices": {
                    "$ref": "#/definitions/storage-account-file-share-service-parameters"
                },
                "storageAccountTableServices": {
                    "$ref": "#/definitions/storage-account-table-service-parameters"
                },
                "storageAccountTags": {
                    "type": "object",
                    "patternProperties": {
                        "^[a-z]": {
                            "type": "string"
                        }
                    },
                    "minProperties": 1
                }
            },
            "if": {
                "properties": {
                    "storageAccountType": {
                        "oneOf": [
                            {
                                "const": "Storage"
                            },
                            {
                                "const": "StorageV2"
                            }
                        ]
                    }
                }
            },
            "then": {
                "properties": {
                    "storageAccountTier": {
                        "type": "object",
                        "properties": {
                            "dev": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "Standard"
                                    },
                                    {
                                        "const": "Premium"
                                    }
                                ]
                            },
                            "qa": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "Standard"
                                    },
                                    {
                                        "const": "Premium"
                                    }
                                ]
                            },
                            "uat": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "Standard"
                                    },
                                    {
                                        "const": "Premium"
                                    }
                                ]
                            },
                            "prd": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "Standard"
                                    },
                                    {
                                        "const": "Premium"
                                    }
                                ]
                            }
                        },
                        "required": [
                            "dev",
                            "qa",
                            "uat",
                            "prd"
                        ]
                    },
                    "storageAccountRedundancy": {
                        "type": "object",
                        "properties": {
                            "dev": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "LRS"
                                    },
                                    {
                                        "const": "GRS"
                                    },
                                    {
                                        "const": "RAGRS"
                                    },
                                    {
                                        "const": "ZRS"
                                    }
                                ]
                            },
                            "qa": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "LRS"
                                    },
                                    {
                                        "const": "GRS"
                                    },
                                    {
                                        "const": "RAGRS"
                                    },
                                    {
                                        "const": "ZRS"
                                    }
                                ]
                            },
                            "uat": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "LRS"
                                    },
                                    {
                                        "const": "GRS"
                                    },
                                    {
                                        "const": "RAGRS"
                                    },
                                    {
                                        "const": "ZRS"
                                    }
                                ]
                            },
                            "prd": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "LRS"
                                    },
                                    {
                                        "const": "GRS"
                                    },
                                    {
                                        "const": "RAGRS"
                                    },
                                    {
                                        "const": "ZRS"
                                    }
                                ]
                            }
                        },
                        "required": [
                            "dev",
                            "qa",
                            "uat",
                            "prd"
                        ]
                    }
                }
            },
            "else": {
                "properties": {
                    "storageAccountTier": {
                        "type": "object",
                        "properties": {
                            "dev": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "Premium"
                                    }
                                ]
                            },
                            "qa": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "Premium"
                                    }
                                ]
                            },
                            "uat": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "Premium"
                                    }
                                ]
                            },
                            "prd": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "Premium"
                                    }
                                ]
                            }
                        },
                        "required": [
                            "dev",
                            "qa",
                            "uat",
                            "prd"
                        ]
                    },
                    "storageAccountRedundancy": {
                        "type": "object",
                        "properties": {
                            "dev": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "LRS"
                                    }
                                ]
                            },
                            "qa": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "LRS"
                                    }
                                ]
                            },
                            "uat": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "LRS"
                                    }
                                ]
                            },
                            "prd": {
                                "type": "string",
                                "oneOf": [
                                    {
                                        "const": "LRS"
                                    }
                                ]
                            }
                        },
                        "required": [
                            "dev",
                            "qa",
                            "uat",
                            "prd"
                        ]
                    }
                }
            },
            "required": [
                "storageAccountName",
                "storageAccountType",
                "storageAccountTier",
                "storageAccountRedundancy"
            ]
        },
        "storage-account-table-services": {
            "type": "object",
            "properties": {
                "value": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/storage-account-table-service-parameters"
                    }
                }
            }
        },
        "storage-account-table-service": {
            "type": "object",
            "properties": {
                "value": {
                    "$ref": "#/definitions/storage-account-table-service-parameters"
                }
            }
        },
        "storage-account-table-service-parameters": {
            "type":"object",
            "properties": {
                "storageAccountName": {
                    "type": "string"
                },
                "storageAccountResourceGroup": {
                    "type": "string"
                },
                "storageAccountTableServiceName": {
                    "type": "string",
                    "default": "default"
                },          
                "storageAccountTableServicePrivateEndpoint": {
                    "$ref": "../../az.private.endpoint/v1.0/parameters.json#/definitions/private-endpoint-embedded"
                },
                "storageAccountTableServiceTables": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/storage-account-table-service-table-parameters"
                    }
                },
                "storageAccountTableServiceCorsPolicy": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "allowedOrigins": {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                },
                                "minItems": 1
                            },
                            "allowedMethods": {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                },
                                "minItems": 1
                            },
                            "allowedHeaders": {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                },
                                "minItems": 1
                            }
                        },
                        "minProperties": 1
                    }
                }
            },
            "required": [
                "storageAccountName",
                "storageAccountResourceGroup"
            ]
        },
        "storage-account-table-service-tables": {
            "type": "object",
            "properties": {
                "value": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/storage-account-table-service-table-parameters"
                    },
                    "minItems": 1
                }
            },
            "required": [
                "value"
            ]
        },
        "storage-account-table-service-table": {
            "type": "object",
            "properties": {
                "value": {
                    "$ref": "#/definitions/storage-account-table-service-table-parameters"
                }
            },
            "required": [
                "value"
            ]
        },
        "storage-account-table-service-table-parameters": {
            "type": "object",
            "properties": {
                "storageAccountName": {
                    "type": "string"
                },
                "storageAccountResourceGroup": {
                    "type": "string"
                },
                "storageAccountTableServiceName": {
                    "type": "string",
                    "default": "default"
                },
                "storageAccountTableServiceTableName": {
                    "type": "string"
                }
            },
            "required": [
                "storageAccountTableName",
                "storageAccountTableServiceName",
                "storageAccountTableServiceTableName",
                "storageAccountResourceGroup"
            ]
        },
        "storage-account-queue-services": {
            "type": "object",
            "properties": {
                "value": {
                    "type": "array",
                    "items": {
                        
                    }
                }
            }
        },
        "storage-account-queue-service": {
            "type": "object",
            "properties": {
                "storageAccountQueueServiceName": {
                    "type": "string",
                    "default": "default"
                },
                "storageAccountQueueServiceQueues": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/storage-account-queue-service-queue"
                    }
                },
                "storageAccountQueueServiceCors": {
                    "type": "array",
                    "description": "The cors rules to apply to the Queue Services under a specific Storage Account.",
                    "items": {
                        "type": "object",
                        "properties": {
                            "allowedOrigins": {
                                "type": "string"
                            },
                            "exposedHeaders": {
                                "type": "string"
                            },
                            "allowedMethods": {
                                "type": "string"
                            },
                            "maxAgeInSeconds": {
                                "type": "string"
                            },
                            "allowedHeaders": {
                                "type": "string"
                            }
                        }
                    }
                },
                "storageAccountQueueServicePrivateEndpoint": {
                    "$ref": "../../az.private.endpoint/v1.0/parameters.json#/definitions/private-endpoint-embedded"
                }
            },
            "required": [
                "storageAccountName",
                "storageAccountResourceGroup",
                "storageAccountQueueServiceName",
                "storageAccountQueueServiceQueues",
                "storageAccountQueueServiceCors",
                "storageAccountQueueServicePrivateEndpoint"
            ]
        },
        "storage-account-queue-service-parameters": {
            "type": "object",
            "properties": {
                "storageAccountName": {
                    "type": "string"
                },
                "storageAccountLocation": {
                    "type": "string"
                },
                "storageAccountResourceGroup": {
                    "type": "string"
                },
                "storageAccountQueueServiceName": {
                    "type": "string",
                    "default": "default"
                },
                "storageAccountQueueServiceQueues": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/storage-account-queue-service-queue-parameters"
                    }
                },
                "storageAccountQueueServiceCors": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "allowedOrigins": {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                },
                                "minItems": 1
                            },
                            "allowedMethods": {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                },
                                "minItems": 1
                            },
                            "allowedHeaders": {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                },
                                "minItems": 1
                            }
                        },
                        "minProperties": 1
                    }
                },
                "storageAccountQueueServicePrivateEndpoint": {
                    "$ref": "../../az.private.endpoint/v1.0/parameters.json#/definitions/private-endpoint-embedded"
                }
            },
            "required": [
                "storageAccountQueueServiceName",
                "storageAccountQueueServiceQueues"
            ]
        },
        "storage-account-queue-service-queue": {
            "type": "object",
            "properties": {
                "value": {
                    "$ref": "#/definitions/storage-account-queue-service-queue-parameters"
                }
            },
            "required": [
                "value"
            ]
        },
        "storage-account-queue-service-queues": {
            "type": "object",
            "properties": {
                "value": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/storage-account-queue-service-queue-parameters"
                    },
                    "minItems": 1
                }
            },
            "required": [
                "value"
            ]
        },
        "storage-account-queue-service-queue-parameters": {
            "type": "object",
            "properties": {
                "storageAccountName": {
                    "type": "string"
                },
                "storageAccountResourceGroup": {
                    "type": "string"
                },
                "storageAccountQueueServiceName": {
                    "type": "string",
                    "default": "default"
                },
                "storageAccountQueueServiceQueueName": {
                    "type": "string"
                }
            },
            "required": [
                "storageAccountName",
                "storageAccountResourceGroup",
                "storageAccountQueueServiceName",
                "storageAccountQueueServiceQueueName"
            ]
        },
        "storage-account-file-share-services": {
            "type": "object",
            "properties": {
                "value": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/storage-account-file-share-service-parameters"
                    },
                    "minItems": 1
                }
            },
            "required": [
                "value"
            ]
        },
        "storage-account-file-share-service": {
            "type": "object",
            "properties": {
                "value": {
                    "$ref": "#/definitions/storage-account-file-share-service-parameters"
                }
            },
            "required": [
                "value"
            ]
        },
        "storage-account-file-share-service-parameters": {
            "type": "object",
            "properties": {
                "storageAccountName": {
                    "type": "string"
                },
                "storageAccountResourceGroup": {
                    "type": "string"
                },
                "storageAccountFileShareServiceName": {
                    "type": "string",
                    "default": "default"
                },
                "storageAccountFileShareServiceDeleteRetentionPolicy": {
                    "type": "object",
                    "properties": {
                        "days": {
                            "type": "number",
                            "maximum": 1
                        },
                        "enabled": {
                            "type": "boolean",
                            "default": true
                        }
                    }
                },
                "storageAccountFileShareServiceCorsPolicy": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "allowedOrigins": {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                },
                                "minItems": 1
                            },
                            "allowedMethods": {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                },
                                "minItems": 1
                            },
                            "allowedHeaders": {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                },
                                "minItems": 1
                            }
                        },
                        "minProperties": 1
                    },
                    "minItems": 1
                },
                "storageAccountFileShareServiceShares": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/storage-account-file-share-service-share-parameters"
                    }
                },
                "storageAccountFileShareServicePrivateEndpoint": {
                    "$ref": "../../az.private.endpoint/v1.0/parameters.json#/definitions/private-endpoint-embedded"
                }
            },
            "required": [
                "storageAccountName"
            ]
        },
        "storage-account-file-share-service-shares": {
            "type": "object",
            "properties": {
                "value": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/storage-account-file-share-service-share-parameters"
                    }
                }
            },
            "required": [
                "value"
            ]
        },
        "storage-account-file-share-service-share": {
            "type": "object",
            "properties": {
                "value": {
                    "$ref": "#/definitions/storage-account-file-share-service-share-parameters"
                }
            },
            "required": [
                "value"
            ]
        },
        "storage-account-file-share-service-share-parameters": {
            "type": "object",
            "properties": {
                "storageAccountName": {
                    "type": "string"
                },
                "storageAccountResourceGroup": {
                    "type": "string"
                },
                "storageAccountFileShareServiceName": {
                    "type": "string"
                },
                "storageAccountFileShareServiceShareName": {
                    "type": "string"
                },
                "storageAccountFileShareServiceShareAccessTier": {
                    "type": "string",
                    "oneOf": [
                        {
                            "const": "Cools"
                        },
                        {
                            "const": "Hot"
                        },
                        {
                            "const": "Premium"
                        },
                        {
                            "const": "TransactionOptimized"
                        }
                    ]
                }
            },
            "required": [
                "storageAccountName",
                "storageAccountFileShareServiceShareName",
                "storageAccountFileShareServiceShareAccessTier"
            ]
        },
        "storage-account-blob-services": {
            "properties": {
                "value": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/storage-account-blob-service-parameters"
                    }
                }
            }
        },
        "storage-account-blob-service": {
            "type": "object",
            "properties": {
                "value": {
                    "$ref": "#/definitions/storage-account-blob-service-parameters"
                }
            },
            "required": [
                "value"
            ]
        },
        "storage-account-blob-service-parameters": {
            "type": "object",
            "properties": {
                "storageAccountName": {
                    "type": "string"
                },
                "storageAccountResourceGroup": {
                    "type": "string"
                },
                "storageAccountBlobServiceName": {
                    "type": "string",
                    "default": "default"
                },
                "storageAccountBlobServiceEnableVersioning": {
                    "type": "boolean"
                },
                "storageAccountBlobServiceEnableSnapshot": {
                    "type": "boolean"
                },
                "storageAccountBlobServiceRetentionPolicy": {
                    "oneOf": [
                        {
                            "type": "object",
                            "properties": {
                                "days": {
                                    "type": "number"
                                }
                            },
                            "required": [
                                "days"
                            ]
                        },
                        {
                            "type": "null"
                        }
                    ]
                },
                "storageAccountBlobServiceRestorePolicy": {
                    "oneOf": [
                        {
                            "type": "object",
                            "properties": {
                                "days": {
                                    "type": "number"
                                }
                            },
                            "required": [
                                "days"
                            ]
                        },
                        {
                            "type": "null"
                        }
                    ]
                },
                "storageAccountBlobServiceContainers": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/storage-account-blob-service-container-parameters"
                    }
                },
                "storageAccountBlobServicePrivateEndpoint": {
                    "$ref": "../../az.private.endpoint/v1.0/parameters.json#/definitions/private-endpoint-embedded"
                }
            },
            "required": [
                "storageAccountBlobServiceName"
            ]
        },
        "storage-account-blob-service-containers": {
            "type": "object",
            "properties": {
                "value": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/storage-account-blob-service-container-parameters"
                    }
                }
            },
            "required": [
                "value"
            ]
        },
        "storage-account-blob-service-container": {
            "type": "object",
            "properties": {
                "value": {
                    "$ref": "#/definitions/storage-account-blob-service-container-parameters"
                }
            },
            "required": [
                "value"
            ]
        },
        "storage-account-blob-service-container-parameters": {
            "type": "object",
            "properties": {
                "storageAccountName": {
                    "type": "string"
                },
                "storageAccountResourceGroup": {
                    "type": "string"
                },
                "storageAccountBlobServiceName": {
                    "type": "string"
                },
                "storageAccountBlobServiceContainerName": {
                    "type": "string"
                },
                "storageAccountBlobServiceContainerEnableVersioning": {
                    "type": "boolean",
                    "default": false
                },
                "storageAccountBlobServiceContainerAccessLevel": {
                    "type": "string",
                    "default": "None",
                    "oneOf": [
                        {
                            "const": "None"
                        },
                        {
                            "const": "Blob"
                        },
                        {
                            "const": "Container"
                        }
                    ]
                }
            },
            "required": [
                "storageAccountName",
                "storageAccountBlobServiceContainerName",
                "storageAccountBlobServiceContainerEnableVersioning",
                "storageAccountBlobServiceContainerAccessLevel"
            ]
        }
    }
}
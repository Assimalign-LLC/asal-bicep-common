{
    "$schema": "http://json-schema.org/draft-07/schema",
    "definitions": {
        "appServiceEnvironments": {
            "properties": {
                "value": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "name": {
                                "type": "string"
                            },
                            "plans": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "name": {
                                            "type": "string"
                                        },
                                        "os": {
                                            "type": "string",
                                            "oneOf": [
                                                {
                                                    "const": "windows"
                                                },
                                                {
                                                    "const": "linux"
                                                }
                                            ]
                                        },
                                        "sku": {
                                            "type": "object",
                                            "properties": {
                                                "dev": {
                                                    "type": "string",
                                                    "oneOf": [
                                                        {
                                                            "const": "D1"
                                                        },
                                                        {
                                                            "const": "B1"
                                                        }
                                                    ]
                                                },
                                                "qa": {
                                                    "type": "string"
                                                },
                                                "uat": {
                                                    "type": "string"
                                                },
                                                "prd": {
                                                    "type": "string"
                                                }
                                            },
                                            "required": [
                                                "dev",
                                                "qa",
                                                "uat",
                                                "prd"
                                            ]
                                        },
                                        "storage": {
                                            "type": "object",
                                            "properties": {
                                                "name": {
                                                    "type": "string"
                                                },
                                                "type": {
                                                    "type": "string",
                                                    "oneOf": [
                                                        {
                                                            "const": "Storage"
                                                        },
                                                        {
                                                            "const": "StorageV2"
                                                        },
                                                        {
                                                            "const": "BlobStorage"
                                                        },
                                                        {
                                                            "const": "BlockBlobStorage"
                                                        },
                                                        {
                                                            "const": "FileStorage"
                                                        }
                                                    ]
                                                },
                                                "accessTier": {
                                                    "type": "string",
                                                    "oneOf": [
                                                        {
                                                            "const": "hot"
                                                        },
                                                        {
                                                            "const": "cool"
                                                        }
                                                    ]
                                                },
                                                "tier": {
                                                    "type": "object",
                                                    "properties": {
                                                        "dev": {
                                                            "type": "string"
                                                        },
                                                        "qa": {
                                                            "type": "string"
                                                        },
                                                        "uat": {
                                                            "type": "string"
                                                        },
                                                        "prd": {
                                                            "type": "string"
                                                        }
                                                    },
                                                    "required": [
                                                        "dev",
                                                        "qa",
                                                        "uat",
                                                        "prd"
                                                    ]
                                                },
                                                "redundancy": {
                                                    "type": "object",
                                                    "properties": {
                                                        "dev": {
                                                            "type": "string",
                                                            "oneOf": [
                                                                {
                                                                    "const": "lrs"
                                                                },
                                                                {
                                                                    "const": "grs"
                                                                },
                                                                {
                                                                    "const": "grzs"
                                                                }
                                                            ]
                                                        },
                                                        "qa": {
                                                            "type": "string",
                                                            "oneOf": [
                                                                {
                                                                    "const": "lrs"
                                                                },
                                                                {
                                                                    "const": "grs"
                                                                },
                                                                {
                                                                    "const": "grzs"
                                                                }
                                                            ]
                                                        },
                                                        "uat": {
                                                            "type": "string",
                                                            "oneOf": [
                                                                {
                                                                    "const": "lrs"
                                                                },
                                                                {
                                                                    "const": "grs"
                                                                },
                                                                {
                                                                    "const": "grzs"
                                                                }
                                                            ]
                                                        },
                                                        "prd": {
                                                            "type": "string",
                                                            "oneOf": [
                                                                {
                                                                    "const": "lrs"
                                                                },
                                                                {
                                                                    "const": "grs"
                                                                },
                                                                {
                                                                    "const": "grzs"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "required": [
                                                        "dev",
                                                        "qa",
                                                        "uat",
                                                        "prd"
                                                    ]
                                                },
                                                "defaultNetworkAccess": {
                                                    "type": "string",
                                                    "default": "Allow",
                                                    "oneOf": [
                                                        {
                                                            "const": "Allow"
                                                        },
                                                        {
                                                            "const": "Deny"
                                                        }
                                                    ]
                                                },
                                                "virtualNetworks": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "allowAccess": {
                                                                "type": "boolean",
                                                                "default": true
                                                            },
                                                            "virtualNetwork": {
                                                                "type": "string"
                                                            },
                                                            "virtualNetworkSubnet": {
                                                                "type": "string"
                                                            },
                                                            "virtualNetworkResourceGroup": {
                                                                "type": "string"
                                                            }
                                                        },
                                                        "required": [
                                                            "allowAccess",
                                                            "virtualNetwork",
                                                            "virtualNetworkSubnet",
                                                            "virtualNetworkResourceGroup"
                                                        ]
                                                    }
                                                },
                                                "resourceAccess": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "resourceName": {
                                                                "type": "string"
                                                            },
                                                            "resourceType": {
                                                                "type": "string"
                                                            },
                                                            "resourceGroup": {
                                                                "type": "string"
                                                            }
                                                        },
                                                        "required": [
                                                            "resourceName",
                                                            "resourceType",
                                                            "resourceGroup"
                                                        ]
                                                    }
                                                },
                                                "blobServices": {
                                                    "oneOf": [
                                                        {
                                                            "type": "null"
                                                        },
                                                        {
                                                            "type": "object",
                                                            "properties": {
                                                                "containers": {
                                                                    "type": "array",
                                                                    "items": {
                                                                        "type": "object",
                                                                        "properties": {
                                                                            "name": {
                                                                                "type": "string"
                                                                            }
                                                                        },
                                                                        "required": [
                                                                            "name"
                                                                        ]
                                                                    }
                                                                },
                                                                "privateEndpoint": {
                                                                    "oneOf": [
                                                                        {
                                                                            "type": "object",
                                                                            "properties": {
                                                                                "name": {
                                                                                    "type": "string"
                                                                                },
                                                                                "privateDnsZone": {
                                                                                    "type": "string"
                                                                                },
                                                                                "privateDnsZoneResourceGroup": {
                                                                                    "type": "string",
                                                                                    "description": ""
                                                                                },
                                                                                "virtualNetwork": {
                                                                                    "type": "string"
                                                                                },
                                                                                "virtualNetworkSubnet": {
                                                                                    "type": "string"
                                                                                },
                                                                                "virtualNetworkResourceGroup": {
                                                                                    "type": "string"
                                                                                }
                                                                            },
                                                                            "required": [
                                                                                "name",
                                                                                "privateDnsZone",
                                                                                "privateDnsZoneResourceGroup",
                                                                                "virtualNetwork",
                                                                                "virtualNetworkSubnet",
                                                                                "virtualNetworkResourceGroup"
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "null"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "required": [
                                                                "containers",
                                                                "privateEndpoint"
                                                            ]
                                                        }
                                                    ]
                                                },
                                                "tableServices": {
                                                    "oneOf": [
                                                        {
                                                            "type": "null"
                                                        },
                                                        {
                                                            "type": "object",
                                                            "properties": {
                                                                "tables": {
                                                                    "type": "array",
                                                                    "items": {
                                                                        "type": "object",
                                                                        "properties": {
                                                                            "name": {
                                                                                "type": "string"
                                                                            }
                                                                        },
                                                                        "required": [
                                                                            "name"
                                                                        ]
                                                                    }
                                                                },
                                                                "privateEndpoint": {
                                                                    "oneOf": [
                                                                        {
                                                                            "type": "object",
                                                                            "properties": {
                                                                                "name": {
                                                                                    "type": "string"
                                                                                },
                                                                                "privateDnsZone": {
                                                                                    "type": "string"
                                                                                },
                                                                                "privateDnsZoneResourceGroup": {
                                                                                    "type": "string",
                                                                                    "description": ""
                                                                                },
                                                                                "virtualNetwork": {
                                                                                    "type": "string"
                                                                                },
                                                                                "virtualNetworkSubnet": {
                                                                                    "type": "string"
                                                                                },
                                                                                "virtualNetworkResourceGroup": {
                                                                                    "type": "string"
                                                                                }
                                                                            },
                                                                            "required": [
                                                                                "name",
                                                                                "privateDnsZone",
                                                                                "privateDnsZoneResourceGroup",
                                                                                "virtualNetwork",
                                                                                "virtualNetworkSubnet",
                                                                                "virtualNetworkResourceGroup"
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "null"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "required": [
                                                                "tables",
                                                                "privateEndpoint"
                                                            ]
                                                        }
                                                    ]
                                                },
                                                "queueServices": {
                                                    "oneOf": [
                                                        {
                                                            "type": "null"
                                                        },
                                                        {
                                                            "type": "object",
                                                            "properties": {
                                                                "queues": {
                                                                    "type": "array",
                                                                    "items": {
                                                                        "type": "object",
                                                                        "properties": {
                                                                            "name": {
                                                                                "type": "string"
                                                                            }
                                                                        },
                                                                        "required": [
                                                                            "name"
                                                                        ]
                                                                    }
                                                                },
                                                                "privateEndpoint": {
                                                                    "oneOf": [
                                                                        {
                                                                            "type": "object",
                                                                            "properties": {
                                                                                "name": {
                                                                                    "type": "string"
                                                                                },
                                                                                "privateDnsZone": {
                                                                                    "type": "string"
                                                                                },
                                                                                "privateDnsZoneResourceGroup": {
                                                                                    "type": "string",
                                                                                    "description": ""
                                                                                },
                                                                                "virtualNetwork": {
                                                                                    "type": "string"
                                                                                },
                                                                                "virtualNetworkSubnet": {
                                                                                    "type": "string"
                                                                                },
                                                                                "virtualNetworkResourceGroup": {
                                                                                    "type": "string"
                                                                                }
                                                                            },
                                                                            "required": [
                                                                                "name",
                                                                                "privateDnsZone",
                                                                                "privateDnsZoneResourceGroup",
                                                                                "virtualNetwork",
                                                                                "virtualNetworkSubnet",
                                                                                "virtualNetworkResourceGroup"
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "null"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "required": [
                                                                "queues",
                                                                "privateEndpoint"
                                                            ]
                                                        }
                                                    ]
                                                },
                                                "fileShareServices": {
                                                    "oneOf": [
                                                        {
                                                            "type": "null"
                                                        },
                                                        {
                                                            "type": "object",
                                                            "properties": {
                                                                "fileShares": {
                                                                    "type": "array",
                                                                    "items": {
                                                                        "type": "object",
                                                                        "properties": {
                                                                            "name": {
                                                                                "type": "string"
                                                                            },
                                                                            "accessTier": {
                                                                                "type": "string",
                                                                                "oneOf": [
                                                                                    {
                                                                                        "const": "cool"
                                                                                    },
                                                                                    {
                                                                                        "const": "hot"
                                                                                    }
                                                                                ]
                                                                            }
                                                                        },
                                                                        "required": [
                                                                            "name",
                                                                            "accessTier"
                                                                        ]
                                                                    }
                                                                },
                                                                "privateEndpoint": {
                                                                    "oneOf": [
                                                                        {
                                                                            "type": "object",
                                                                            "properties": {
                                                                                "name": {
                                                                                    "type": "string"
                                                                                },
                                                                                "privateDnsZone": {
                                                                                    "type": "string"
                                                                                },
                                                                                "privateDnsZoneResourceGroup": {
                                                                                    "type": "string",
                                                                                    "description": ""
                                                                                },
                                                                                "virtualNetwork": {
                                                                                    "type": "string"
                                                                                },
                                                                                "virtualNetworkSubnet": {
                                                                                    "type": "string"
                                                                                },
                                                                                "virtualNetworkResourceGroup": {
                                                                                    "type": "string"
                                                                                }
                                                                            },
                                                                            "required": [
                                                                                "name",
                                                                                "privateDnsZone",
                                                                                "privateDnsZoneResourceGroup",
                                                                                "virtualNetwork",
                                                                                "virtualNetworkSubnet",
                                                                                "virtualNetworkResourceGroup"
                                                                            ]
                                                                        },
                                                                        {
                                                                            "type": "null"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "required": [
                                                                "fileShares",
                                                                "privateEndpoint"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            "if": {
                                                "properties": {
                                                    "type": {
                                                        "oneOf": [
                                                            {
                                                                "const": "Storage"
                                                            },
                                                            {
                                                                "const": "StorageV2"
                                                            }
                                                        ]
                                                    }
                                                }
                                            },
                                            "then": {
                                                "properties": {
                                                    "tier": {
                                                        "type": "object",
                                                        "properties": {
                                                            "dev": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "Standard"
                                                                    },
                                                                    {
                                                                        "const": "Premium"
                                                                    }
                                                                ]
                                                            },
                                                            "qa": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "Standard"
                                                                    },
                                                                    {
                                                                        "const": "Premium"
                                                                    }
                                                                ]
                                                            },
                                                            "uat": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "Standard"
                                                                    },
                                                                    {
                                                                        "const": "Premium"
                                                                    }
                                                                ]
                                                            },
                                                            "prd": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "Standard"
                                                                    },
                                                                    {
                                                                        "const": "Premium"
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        "required": [
                                                            "dev",
                                                            "qa",
                                                            "uat",
                                                            "prd"
                                                        ]
                                                    },
                                                    "redundancy": {
                                                        "type": "object",
                                                        "properties": {
                                                            "dev": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "lrs"
                                                                    },
                                                                    {
                                                                        "const": "grs"
                                                                    },
                                                                    {
                                                                        "const": "grzs"
                                                                    }
                                                                ]
                                                            },
                                                            "qa": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "lrs"
                                                                    },
                                                                    {
                                                                        "const": "grs"
                                                                    },
                                                                    {
                                                                        "const": "grzs"
                                                                    }
                                                                ]
                                                            },
                                                            "uat": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "lrs"
                                                                    },
                                                                    {
                                                                        "const": "grs"
                                                                    },
                                                                    {
                                                                        "const": "grzs"
                                                                    }
                                                                ]
                                                            },
                                                            "prd": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "lrs"
                                                                    },
                                                                    {
                                                                        "const": "grs"
                                                                    },
                                                                    {
                                                                        "const": "grzs"
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        "required": [
                                                            "dev",
                                                            "qa",
                                                            "uat",
                                                            "prd"
                                                        ]
                                                    }
                                                }
                                            },
                                            "else": {
                                                "properties": {
                                                    "tier": {
                                                        "type": "object",
                                                        "properties": {
                                                            "dev": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "Premium"
                                                                    }
                                                                ]
                                                            },
                                                            "qa": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "Premium"
                                                                    }
                                                                ]
                                                            },
                                                            "uat": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "Premium"
                                                                    }
                                                                ]
                                                            },
                                                            "prd": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "Premium"
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        "required": [
                                                            "dev",
                                                            "qa",
                                                            "uat",
                                                            "prd"
                                                        ]
                                                    },
                                                    "redundancy": {
                                                        "type": "object",
                                                        "properties": {
                                                            "dev": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "lrs"
                                                                    }
                                                                ]
                                                            },
                                                            "qa": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "lrs"
                                                                    }
                                                                ]
                                                            },
                                                            "uat": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "lrs"
                                                                    }
                                                                ]
                                                            },
                                                            "prd": {
                                                                "type": "string",
                                                                "oneOf": [
                                                                    {
                                                                        "const": "lrs"
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        "required": [
                                                            "dev",
                                                            "qa",
                                                            "uat",
                                                            "prd"
                                                        ]
                                                    }
                                                }
                                            },
                                            "required": [
                                                "name",
                                                "type",
                                                "tier",
                                                "accessTier",
                                                "defaultNetworkAccess",
                                                "virtualNetworks",
                                                "resourceAccess",
                                                "blobServices",
                                                "tableServices",
                                                "queueServices",
                                                "fileShareServices"
                                            ]
                                        }
                                    },
                                    "required": [
                                        "name",
                                        "os",
                                        "sku",
                                        "storage"
                                    ]
                                }
                            }
                        }
                    }
                }
            },
            "required": [
                "value"
            ]
        }
    }
}